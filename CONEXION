import { error } from 'console';
import dotenv from 'dotenv';
import express from 'express';
import { connect } from 'http2';
import mysql from 'mysql2';
dotenv.config();

const appExpress = express();
appExpress.use(express.json());
appExpress.use(express.text());


appExpress.get("/", (req, res) => {
    res.send('200 STATUS OK');
});

appExpress.get("/persona", (req, res) => {
    connection.query("SELECT * FROM persona", (err, rows) => {
        err ? res.send(err) : res.send(rows);
    })
})

let config = JSON.parse(process.env.MY_CONFIG);
appExpress.listen(config.port, config.hostname, () => {
    console.log(`http://${config.hostname}:${config.port}`);
});

const connection = mysql.createConnection({
    host: process.env.HOST,
    user: process.env.USUARIO,
    password: process.env.PASSWORD,
    database: process.env.DATABASE
})

connection.connect((err) => {
    err ? console.log("Error de conexi√≥n", err) : console.log("Conexion exitosa");
})
